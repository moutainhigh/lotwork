!function(a,b,c,d){var e,f={URL:"",handlingChargeURL:""},g=a.Games,h={init:function(){{var a=this;a.defConfig}a.URL=g.getCurrentGame().getGameConfig().getInstance().submitUrl(),a.handlingChargeURL=g.getCurrentGame().getGameConfig().getInstance().getHandingChargeUrl(),a.postLock=null,g.setCurrentGameSubmit(a),a.addEvent("afterSubmit",function(){a.cancelPostLock()})},formatMoney:function(a){var a=Number(a),b=/(-?\d+)(\d{3})/;for(a=Number.prototype.toFixed?a.toFixed(2):Math.round(100*a)/100,a=""+a;b.test(a);)a=a.replace(b,"$1,$2");return a},getSubmitData:function(){var a={},b=g.getCurrentGameOrder().orderData,c=0,d=b.length,e=g.getCurrentGameTrace().getResultData(),f=0,h=e.traceData.length;for(a.gameType=g.getCurrentGame().getName(),a.isTrace=e.traceData.length>0?1:0,a.traceWinStop=g.getCurrentGameTrace().getIsWinStop(),a.traceStopValue=g.getCurrentGameTrace().getTraceWinStopValue(),a.balls=[],a.ordersNumber="";d>c;c++)a.balls.push({id:b[c].id,ball:b[c].postParameter,type:b[c].type,moneyunit:b[c].moneyUnit,multiple:b[c].multiple,num:b[c].num});if(a.orders=[],a.isTrace<1)a.orders.push({number:g.getCurrentGame().getCurrentNumber(),issueCode:g.getCurrentGame().getCurrentIssueCode(),multiple:1}),a.amount=g.getCurrentGameStatistics().formatMoney(g.getCurrentGameOrder().getTotal().amount),a.ordersNumber="第 "+g.getCurrentGame().getCurrentNumber()+" 期",a.onlyAmount="";else{for(;h>f;f++)a.orders.push({number:e.traceData[f].traceNumber,issueCode:Number(e.traceData[f].issueCode),multiple:e.traceData[f].multiple});a.ordersNumber="第 "+a.orders[0].number+"  至  "+a.orders[h-1].number+"   共  <strong class='color-red'>"+h+"</strong></span>  期",a.amount=g.getCurrentGameStatistics().formatMoney(e.amount,2),a.onlyAmount=e.orderData.amount}return a},doPostLock:function(){var a=this;a.postLock=!0},cancelPostLock:function(){var a=this;a.postLock=null},clearData:function(){var a=g.getCurrentGameOrder();a.reSet(),a.cancelSelectOrder(),g.getCurrentGame().getCurrentGameMethod().reSet()},afterSubmitSuccess:function(){var a="",b="",c=this;try{$.ajax({dataType:"json",cache:!1,url:g.getCurrentGame().getGameConfig().getInstance().getUserOrdersUrl(),cache:!1,success:function(b){$.isEmptyObject(b)||($("#program-user-orders > tbody").html(""),$.each(b,function(d){a+='<tr><td><a target="_black" href="/gameUserCenter/queryOrderDetail?orderId='+b[d].orderId+'"> '+b[d].webIssueCode+"</a></td>",a+="<td></td><td><span class='price'><dfn>&yen;</dfn>"+c.formatMoney(b[d].totamount/1e4)+"</span></td><td></td>",a+=2==Number(b[d].status)?"<td >中<span class='price color-red'><dfn>&yen;</dfn>"+c.formatMoney(b[d].totwin/1e4)+"</td></span></tr>":"<td >"+b[d].statusName+"</td></tr>"}),$("#program-user-orders > tbody").append(a))}}),$.ajax({dataType:"json",cache:!1,url:g.getCurrentGame().getGameConfig().getInstance().getUserPlansUrl(),cache:!1,success:function(a){$.isEmptyObject(a)||($("#program-user-plans > tbody").html(""),$.each(a,function(d){switch(b+='<tr><td><a target="_black" href="/gameUserCenter/queryPlanDetail?planid='+a[d].planid+'"> '+a[d].startWebIssueCode+"</a></td>",b+="<td>"+Number(a[d].finishIssue)+"/"+Number(a[d].totalIssue)+"</td>",b+="<td><span class='price'><dfn>&yen;</dfn>"+c.formatMoney(a[d].totamount/1e4)+" </span></td>",a[d].status){case 0:b+="<td >未开始</td></tr>";break;case 1:b+="<td >进行中</td></tr>";break;case 2:b+="<td >已结束</td></tr>";break;case 3:b+="<td >已终止</td></tr>";break;case 4:b+="<td >暂停</td></tr>";break;default:b+="<td ></td></tr>"}}),$("#program-user-plans > tbody").append(b))}})}catch(d){alert("网络异常，读取信息失败")}},balanceInquiry:function(a){$.ajax({dataType:"json",cache:!1,url:g.getCurrentGame().getGameConfig().getInstance().getUserBalUrl(),data:"",success:function(b){var c=""==b?0:b,d=phoenix.util.formatMoney(c/1e4);$("#"+a).html(d)}})},submitData:function(){var a=this,b=a.getSubmitData(),c=g.getCurrentGameMessage();if(b.balls.length<=0)return c.show({type:"mustChoose",msg:"请至少选择一注投注号码！",data:{tplData:{msg:"请至少选择一注投注号码！"}}}),void a.cancelPostLock();var e=!0;c.show({type:"checkLotters",msg:"请核对您的投注信息！",confirmIsShow:!0,confirmFun:function(){a.postLock||(a.doPostLock(),a.fireEvent("beforeSubmit"),b.ordersNumber=d,b.onlyAmount=d,b.amount=phoenix.util.formatFloat(b.amount),$.ajax({url:g.getCurrentGame().getGameConfig().getInstance().submitUrl(),data:JSON.stringify(g.getCurrentGame().editSubmitData(b)),dataType:"json",method:"POST",cache:!1,contentType:"application/json; charset=utf-8",beforeSend:function(){return e?($(".confirm").html("提交中..."),$(".cancel").css("display","none").attr("disabled","true"),e=!1,void 0):!1},success:function(d){if(1==Number(d.isSuccess)){var e=Number(b.isTrace)>0?1:0;e>0?(d.data.tplData.url="/gameUserCenter/queryPlans?time=7",d.data.tplData.gameType="追号记录"):(d.data.tplData.url="/gameUserCenter/queryOrdersEnter?time=7",d.data.tplData.gameType="投注记录"),c.show(d),a.clearData(),g.getCurrentGameSubmit().balanceInquiry("spanBall"),a.afterSubmitSuccess(),setTimeout(function(){g.getCurrentGameTrace().hide(),$("html,body").animate({scrollTop:$("#J-top-game-menu").offset().top},1e3)},1500)}else c.show(d)},complete:function(){a.fireEvent("afterSubmit"),e=!0,$(".cancel").css("display","display").removeAttr("disabled")},error:function(a){c.show("404"==a.status||"0"==a.status?{mask:!0,title:"温馨提示",content:"<div class='pop-title'><i class='ico-error'></i><h4 class='pop-text'>登录超时 请重新登入！</h4></div>",cancelIsShow:!0,cancelFun:function(){window.location.reload()}}:{mask:!0,title:"温馨提示",content:"<div class='pop-title'><i class='ico-error'></i><h4 class='pop-text'>方案提交失败,<br />请检查网络并重新提交！</h4></div>",cancelIsShow:!0,cancelFun:function(){c.hide()}})}}))},cancelIsShow:!0,cancelFun:function(){a.cancelPostLock(),this.hide()},normalCloseFun:function(){a.cancelPostLock()},callback:function(){var a=Number(g.getCurrentGame().getGameConfig().getInstance().defConfig.backOutStartFee)/1e4,d=Number(g.getCurrentGame().getGameConfig().getInstance().defConfig.backOutRadio)/1e4,e=g.getCurrentGameStatistics().ToForamtmoney(b.amount);e>a&&($("#showLotteryChareg").show(),c.getContentDom().find(".handlingCharge").html(g.getCurrentGameStatistics().formatMoney(e*d,3)))},data:{tplData:{lotteryDate:b.ordersNumber,lotteryName:g.getCurrentGame().getGameConfig().getInstance().getGameTypeCn(),lotteryInfo:function(){for(var a="",c=b.balls,d=0;d<c.length;d++){var e=c[d];a+='<div style="line-height:25px;">'+g.getCurrentGame().getGameConfig().getInstance().getTitleByName(e.type).join("")+" "+e.ball+"</div>"}return a},lotteryamount:b.amount,lotteryAcc:g.getCurrentGame().getDynamicConfig().username,lotteryOnlyAmount:b.onlyAmount,lotteryTraceInfo:function(){var a="";return b.isTrace>0&&(a=b.orders),a}}}})}},i=a.Class(h,c);i.defConfig=f,i.getInstance=function(a){return e||(e=new i(a))},a[b]=i}(phoenix,"GameSubmit",phoenix.Event);