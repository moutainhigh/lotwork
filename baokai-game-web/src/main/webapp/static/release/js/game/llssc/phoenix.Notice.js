!function(a,b,c,d){var e={delayTime:0,serviceUrl:"",serviceGetType:"once",msgPushWaitTime:3,tipsHiddenTime:6,cycleTime:5,cycleType:"bottom",reloadType:"auto",noticeHtml:'<div class="public-notice"><div class="inner"><i class="ico-close"></i><i class="ico-volume"></i><#=msg#></div></div>',tipsHtml:'<div class="public-notice"><div class="inner"><i class="ico-close"></i><i class="ico-volume"></i><#=msg#></div></div>',tipsContainer:"<ul></ul>"},f={init:function(){var a=this;a.cycleTime=null,a.timestamp=0,a.addEvent("afterGetServiceData",function(b,c){a.getMethodByName(c.data)}),a.addEvent("afterGetServicePush",function(b,c){a.getMethodByName(c.data)})},setdelayTime:function(a){this.defConfig.delayTime=a},getdelayTime:function(){return this.defConfig.delayTime},setMsgPushWaitTime:function(a){this.defConfig.msgPushWaitTime=a},getMsgPushWaitTime:function(){return this.defConfig.msgPushWaitTime},setServiceGetType:function(a){this.defConfig.serviceGetType=a},getServiceGetType:function(){return this.defConfig.serviceGetType},getServiceUrl:function(){return this.defConfig.serviceUrl},setServiceUrl:function(a){this.defConfig.serviceUrl=a},getNoticeHtml:function(){return this.defConfig.noticeHtml},setNoticeHtml:function(a){this.defConfig.noticeHtml=a},getTipsHtml:function(){return this.defConfig.tipsHtml},setTipsHtml:function(a){this.defConfig.tipsHtml=a},setCycleType:function(a){this.defConfig.cycleType=a},getCycleType:function(){return this.defConfig.cycleType},getCycleTime:function(){return this.defConfig.cycleTime},setCycleTime:function(a){this.defConfig.cycleTime=a},getTipsContainerHtml:function(){},setTipsContainerHtml:function(){},formatRow:function(a,b){var c,d,e=b;for(c in e)e.hasOwnProperty(c)&&(d=RegExp("<#="+c+"#>","g"),a=a.replace(d,e[c]));return a},startLoadData:function(){var a=this,b=a.getdelayTime()||0;setTimeout(function(){a.getServiceData()},1e3*b)},getServiceData:function(){var a=this;"once"==a.getServiceGetType()?a.getServiceDataOnce():"push"==a.getServiceGetType()&&a.getServiceDataRepeat()},getServiceDataOnce:function(){var a=this;d.ajax({url:a.getServiceUrl(),type:"GET",dataType:"json",success:function(b){1==b.isSuccess?a.fireEvent("afterGetServiceData",b):a.errorTips(b)},error:function(){a.errorTips({name:"netError",msg:"服务器数据异常"})}})},getServiceDataRepeat:function(){var a=this;d.ajax({url:a.getServiceUrl(),type:"GET",dataType:"json",data:{timestamp:a.timestamp},success:function(b){1==b.isSuccess?(a.timestamp=b.timestamp,"undefined"!=typeof b.time&&Number(time)&&a.setMsgPushWaitTime(Number(time)),a.fireEvent("afterGetServicePush",b)):a.errorTips(b)},error:function(){},complete:function(){a.reloadService()}})},reloadService:function(){var a=this;setTimeout(function(){a.getServiceDataRepeat()},1e3*a.getMsgPushWaitTime())},getMethodByName:function(a){var b,c,e=this,f=0;if(e.fireEvent("beforStartMethod",a),!(a.length<=0))for(;f<a.length;f++)if(c=a[f].name,b=a[f].tplData,"undefined"!=typeof e[c]&&d.isFunction(e[c]))e[c](b);else try{console.log("缺少数据接口: "+c)}catch(g){}},errorTips:function(a){var b=this,c=a.name,a=a.Tpldata,e=b[c+"error"];"undefined"!=typeof e&&d.isFunction(e)&&e(a)},messageNotice:function(a){var b=this,c=[];c.push("<ul>");for(var e=0;e<a.length;e++)c.push('<li><a href="'+a[e].url+'">'+a[e].text+"</a></li>");c.push("</ul>"),b.messageNoticeDom=d(b.formatRow(b.getNoticeHtml(),{msg:c.join("")})),b.messageNoticeDom.addClass("messageNotice"),d("body").prepend(b.messageNoticeDom),b.messageNoticeShow(),b.bindEventNotice(b.messageNoticeDom,"message"),b.messageCycleStart(b.messageNoticeDom.find("ul"),"li","message")},bindEventNotice:function(a,b){var c=this;a.bind("mouseenter",function(){c.messageCycleStop(b,a)}),a.bind("mouseleave",function(){c.messageCycleStart(a.find("ul"),"li",b)})},messageCycleStart:function(a,b,c){var d,e=this,f=a.find(b),g=f.eq(0).outerHeight();return f.size()>1&&(e[c]=setInterval(function(){d=a.find(b),"top"==e.getCycleType()?d.eq(0).animate({marginTop:-g},390,function(){a.append(d.eq(0)),d.eq(0).css("marginTop",0)}):"bottom"==e.getCycleType()&&(d=d.eq(d.length-1),a.prepend(d),d.css("marginTop",-g),d.eq(0).animate({marginTop:0},390))},1e3*e.getCycleTime())),e},messageCycleStop:function(a,b){var c=this;return b&&b.find("li").is(":animated")&&b.find("li").stop(),c[a]&&(clearInterval(c[a]),c[a]=null),c},messageNoticeError:function(){},messageNoticeShow:function(){var a=this,b=a.messageNoticeDom;return b.animate({height:28}),a},messageNoticehide:function(){var a=this,b=a.messageNoticeDom;return b.animate({height:0}),a},messageTips:function(a){for(var b=this,c=[],e=0;e<a.length;e++)c.push(a[e].html);c=d(c.join("")),b.tipsContainer.prepend(c),b.startTipsHidden(c),b.bindEventTips(c)},addTipsContainerDom:function(){var a=this;return a.tipsContainer=d('<ul class="game_tipscontainer ie6fixedBR"></ul>'),d("body").append(a.tipsContainer),a},startTipsHidden:function(a){var b=this;setTimeout(function(){a.fadeOut(5e3,function(){d(this).remove(),d(this).unbind()})},1e3*b.defConfig.tipsHiddenTime)},bindEventTips:function(a){var b=this,c=null;a.bind("mouseenter",function(){c&&(clearTimeout(c),c=null),d(this).is(":animated")&&(d(this).stop(),d(this).css("opacity","1"))}),a.bind("mouseleave",function(){var a=d(this);c=setTimeout(function(){b.startTipsHidden(a)},500)}),a.find(".close_btn").bind("click",function(){d(this).parent().remove()})},messageTipsError:function(){},gameMessageNotice:function(a){var b=this,c=[];c.push("<ul>");for(var e=0;e<a.length;e++)c.push('<li><a href="'+a[e].url+'">'+a[e].text+"</a></li>");c.push("</ul>"),b.gameMessageNoticeDom=d(b.formatRow(b.getNoticeHtml(),{msg:c.join("")})),b.gameMessageNoticeDom.addClass("gameMessageNotice"),d(".main").prepend(b.gameMessageNoticeDom),b.gameMessageNoticeShow(),b.bindEventNotice(b.gameMessageNoticeDom,"gameMessage"),b.messageCycleStart(b.gameMessageNoticeDom.find("ul"),"li","gameMessage")},gameMessageNoticeShow:function(){var a=this,b=a.gameMessageNoticeDom;return b.animate({height:28}),a},gameMessageNoticehide:function(){var a=this,b=a.gameMessageNoticeDom;return b.animate({height:0}),a}},g=a.Class(f,c);g.defConfig=e,a[b]=g}(phoenix,"Notice",phoenix.Event,jQuery),$(function(){var a=new phoenix.Notice({delayTime:2,serviceUrl:"/static/js/json/msgNotice.json"});a.startLoadData(),$("body").on("click",".messageNotice .ico-close",function(){a.messageNoticehide().messageCycleStop("message")}),$("body").on("click",".gameMessageNotice .ico-close",function(){a.gameMessageNoticehide().messageCycleStop("gameMessage")});new phoenix.Notice({delayTime:5,serviceUrl:"/static/js/json/msgTipsPush.json",serviceGetType:"push",msgPushWaitTime:8})});